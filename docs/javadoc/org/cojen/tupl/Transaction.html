<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Transaction (Tupl 1.5.0 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Transaction (Tupl 1.5.0 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":18,"i1":18,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":18,"i13":6,"i14":6,"i15":6,"i16":6,"i17":6,"i18":6,"i19":6,"i20":6,"i21":6,"i22":6,"i23":6,"i24":6,"i25":6,"i26":6,"i27":6,"i28":18,"i29":6,"i30":18,"i31":6,"i32":6,"i33":6,"i34":6,"i35":6,"i36":6,"i37":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = false;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Transaction.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.cojen.tupl</a></div>
<h2 title="Interface Transaction" class="title">Interface Transaction</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/Flushable.html?is-external=true" title="class or interface in java.io" class="externalLink">Flushable</a></code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">Transaction</span>
extends <a href="https://docs.oracle.com/javase/10/docs/api/java/io/Flushable.html?is-external=true" title="class or interface in java.io" class="externalLink">Flushable</a></pre>
<div class="block">Defines a logical unit of work. Transaction instances can only be safely
 used by one thread at a time, and they must be <a href="#reset()"><code>reset</code></a> when no
 longer needed. Instances can be exchanged by threads, as long as a
 happens-before relationship is established. Without proper exclusion,
 multiple threads interacting with a Transaction instance may cause database
 corruption.

 <p>Transactions also contain various methods for directly controlling locks,
 although their use is not required. Methods which operate upon transactions
 acquire and release locks automatically. Direct control over locks is
 provided for advanced use cases. One such use is record filtering:

 <pre>
 Transaction txn = ...
 Cursor c = index.newCursor(txn);
 for (LockResult result = c.first(); c.key() != null; result = c.next()) {
     if (shouldDiscard(c.value()) &amp;&amp; result == LockResult.ACQUIRED) {
         // Unlock record which doesn't belong in the transaction.
         txn.unlock();
         continue;
     }
     ...
 }
 </pre>

 <p>Note: Transaction instances are never fully closed after they are reset
 or have fully exited. Any operation which acts upon a reset transaction can
 resurrect it.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="Database.html#newTransaction()"><code>Database.newTransaction</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static <a href="Transaction.html" title="interface in org.cojen.tupl">Transaction</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#BOGUS">BOGUS</a></span></code></th>
<td class="colLast">
<div class="block">Transaction instance which isn't a transaction at all.</div>
</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="tableTab" onclick="show(4);">Abstract Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t5" class="tableTab" onclick="show(16);">Default Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>default void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#attach(java.lang.Object)">attach</a></span>&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;obj)</code></th>
<td class="colLast">
<div class="block">Attach an arbitrary object to this transaction instance, for tracking it.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>default <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#attachment()">attachment</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns any attachment which was set earlier.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#check()">check</a></span>()</code></th>
<td class="colLast">
<div class="block">Checks the validity of the transaction.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#commit()">commit</a></span>()</code></th>
<td class="colLast">
<div class="block">Commits all modifications made within the current transaction scope.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#commitAll()">commitAll</a></span>()</code></th>
<td class="colLast">
<div class="block">Commits and exits all transaction scopes.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#customRedo(byte%5B%5D,long,byte%5B%5D)">customRedo</a></span>&#8203;(byte[]&nbsp;message,
          long&nbsp;indexId,
          byte[]&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Supply a message for a custom redo handler.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#customUndo(byte%5B%5D)">customUndo</a></span>&#8203;(byte[]&nbsp;message)</code></th>
<td class="colLast">
<div class="block">Supply a message for a custom undo handler.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code><a href="DurabilityMode.html" title="enum in org.cojen.tupl">DurabilityMode</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#durabilityMode()">durabilityMode</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the durability mode of this transaction.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#durabilityMode(org.cojen.tupl.DurabilityMode)">durabilityMode</a></span>&#8203;(<a href="DurabilityMode.html" title="enum in org.cojen.tupl">DurabilityMode</a>&nbsp;mode)</code></th>
<td class="colLast">
<div class="block">Sets the durability mode for the entire transaction, not just the current scope.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#enter()">enter</a></span>()</code></th>
<td class="colLast">
<div class="block">Enters a nested transaction scope.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#exit()">exit</a></span>()</code></th>
<td class="colLast">
<div class="block">Exits the current transaction scope, rolling back all uncommitted
 modifications made within.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flush()">flush</a></span>()</code></th>
<td class="colLast">
<div class="block">Manually flush all buffered changes made by this transaction to the shared redo
 log.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>default long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getId()">getId</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the currently assigned identifier for this transaction, which is zero when the
 transaction cannot replicate.</div>
</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isNested()">isNested</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true if the current transaction scope is nested.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lastLockedIndex()">lastLockedIndex</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the index id of the last lock acquired, within the current scope.</div>
</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lastLockedKey()">lastLockedKey</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the key of the last lock acquired, within the current scope.</div>
</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockCheck(long,byte%5B%5D)">lockCheck</a></span>&#8203;(long&nbsp;indexId,
         byte[]&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Checks the lock ownership for the given key.</div>
</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockExclusive(long,byte%5B%5D)">lockExclusive</a></span>&#8203;(long&nbsp;indexId,
             byte[]&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks.</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockExclusive(long,byte%5B%5D,long)">lockExclusive</a></span>&#8203;(long&nbsp;indexId,
             byte[]&nbsp;key,
             long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks.</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code><a href="LockMode.html" title="enum in org.cojen.tupl">LockMode</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockMode()">lockMode</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the current lock mode.</div>
</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockMode(org.cojen.tupl.LockMode)">lockMode</a></span>&#8203;(<a href="LockMode.html" title="enum in org.cojen.tupl">LockMode</a>&nbsp;mode)</code></th>
<td class="colLast">
<div class="block">Sets the lock mode for the current scope.</div>
</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockShared(long,byte%5B%5D)">lockShared</a></span>&#8203;(long&nbsp;indexId,
          byte[]&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks.</div>
</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockShared(long,byte%5B%5D,long)">lockShared</a></span>&#8203;(long&nbsp;indexId,
          byte[]&nbsp;key,
          long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks.</div>
</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockTimeout(long,java.util.concurrent.TimeUnit)">lockTimeout</a></span>&#8203;(long&nbsp;timeout,
           <a href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)</code></th>
<td class="colLast">
<div class="block">Sets the lock timeout for the current scope.</div>
</td>
</tr>
<tr class="altColor" id="i24">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockTimeout(java.util.concurrent.TimeUnit)">lockTimeout</a></span>&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)</code></th>
<td class="colLast">
<div class="block">Returns the current lock timeout, in the given unit.</div>
</td>
</tr>
<tr class="rowColor" id="i25">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockUpgradable(long,byte%5B%5D)">lockUpgradable</a></span>&#8203;(long&nbsp;indexId,
              byte[]&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks.</div>
</td>
</tr>
<tr class="altColor" id="i26">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lockUpgradable(long,byte%5B%5D,long)">lockUpgradable</a></span>&#8203;(long&nbsp;indexId,
              byte[]&nbsp;key,
              long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks.</div>
</td>
</tr>
<tr class="rowColor" id="i27">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#nestingLevel()">nestingLevel</a></span>()</code></th>
<td class="colLast">
<div class="block">Counts the current transaction scope nesting level.</div>
</td>
</tr>
<tr class="altColor" id="i28">
<td class="colFirst"><code>default void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepare()">prepare</a></span>()</code></th>
<td class="colLast">
<div class="block">Prepares a transaction for finishing a two-phase commit, to be called before fully
 committing the transaction.</div>
</td>
</tr>
<tr class="rowColor" id="i29">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#reset()">reset</a></span>()</code></th>
<td class="colLast">
<div class="block">Exits all transaction scopes, rolling back all uncommitted modifications.</div>
</td>
</tr>
<tr class="altColor" id="i30">
<td class="colFirst"><code>default void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#reset(java.lang.Throwable)">reset</a></span>&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Throwable</a>&nbsp;cause)</code></th>
<td class="colLast">
<div class="block">Reset the transaction due to the given cause.</div>
</td>
</tr>
<tr class="rowColor" id="i31">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tryLockExclusive(long,byte%5B%5D,long)">tryLockExclusive</a></span>&#8203;(long&nbsp;indexId,
                byte[]&nbsp;key,
                long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks.</div>
</td>
</tr>
<tr class="altColor" id="i32">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tryLockShared(long,byte%5B%5D,long)">tryLockShared</a></span>&#8203;(long&nbsp;indexId,
             byte[]&nbsp;key,
             long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks.</div>
</td>
</tr>
<tr class="rowColor" id="i33">
<td class="colFirst"><code><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#tryLockUpgradable(long,byte%5B%5D,long)">tryLockUpgradable</a></span>&#8203;(long&nbsp;indexId,
                 byte[]&nbsp;key,
                 long&nbsp;nanosTimeout)</code></th>
<td class="colLast">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks.</div>
</td>
</tr>
<tr class="altColor" id="i34">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unlock()">unlock</a></span>()</code></th>
<td class="colLast">
<div class="block">Fully releases the last lock or group acquired, within the current scope.</div>
</td>
</tr>
<tr class="rowColor" id="i35">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unlockCombine()">unlockCombine</a></span>()</code></th>
<td class="colLast">
<div class="block">Combines the last lock acquired or upgraded into a group which can be unlocked together.</div>
</td>
</tr>
<tr class="altColor" id="i36">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unlockToShared()">unlockToShared</a></span>()</code></th>
<td class="colLast">
<div class="block">Releases the last lock or group acquired, within the current scope, retaining a shared
 lock.</div>
</td>
</tr>
<tr class="rowColor" id="i37">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unlockToUpgradable()">unlockToUpgradable</a></span>()</code></th>
<td class="colLast">
<div class="block">Releases the last lock or group acquired or upgraded, within the current scope,
 retaining an upgradable lock.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="BOGUS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BOGUS</h4>
<pre>static final&nbsp;<a href="Transaction.html" title="interface in org.cojen.tupl">Transaction</a> BOGUS</pre>
<div class="block">Transaction instance which isn't a transaction at all. It always
 operates in an <a href="LockMode.html#UNSAFE"><code>unsafe</code></a> lock mode and a <a href="DurabilityMode.html#NO_REDO"><code>no-redo</code></a> durability mode. For safe auto-commit
 transactions, pass null for the transaction argument.</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="lockMode(org.cojen.tupl.LockMode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockMode</h4>
<pre class="methodSignature">void&nbsp;lockMode&#8203;(<a href="LockMode.html" title="enum in org.cojen.tupl">LockMode</a>&nbsp;mode)</pre>
<div class="block">Sets the lock mode for the current scope. Transactions begin in <a href="LockMode.html#UPGRADABLE_READ"><code>UPGRADABLE_READ</code></a> mode, and newly entered scopes
 begin at the outer scope's current mode. Exiting a scope reverts the
 lock mode.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mode</code> - new lock mode</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - if mode is null</dd>
</dl>
</li>
</ul>
<a id="lockMode()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockMode</h4>
<pre class="methodSignature"><a href="LockMode.html" title="enum in org.cojen.tupl">LockMode</a>&nbsp;lockMode()</pre>
<div class="block">Returns the current lock mode.</div>
</li>
</ul>
<a id="lockTimeout(long,java.util.concurrent.TimeUnit)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockTimeout</h4>
<pre class="methodSignature">void&nbsp;lockTimeout&#8203;(long&nbsp;timeout,
                 <a href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)</pre>
<div class="block">Sets the lock timeout for the current scope. A negative timeout is
 infinite.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>unit</code> - required unit if timeout is more than zero</dd>
</dl>
</li>
</ul>
<a id="lockTimeout(java.util.concurrent.TimeUnit)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockTimeout</h4>
<pre class="methodSignature">long&nbsp;lockTimeout&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">TimeUnit</a>&nbsp;unit)</pre>
<div class="block">Returns the current lock timeout, in the given unit.</div>
</li>
</ul>
<a id="durabilityMode(org.cojen.tupl.DurabilityMode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>durabilityMode</h4>
<pre class="methodSignature">void&nbsp;durabilityMode&#8203;(<a href="DurabilityMode.html" title="enum in org.cojen.tupl">DurabilityMode</a>&nbsp;mode)</pre>
<div class="block">Sets the durability mode for the entire transaction, not just the current scope. The
 durability mode primarily affects commit behavior at the top-level scope, but it can also
 be used to switch redo logging behavior.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mode</code> - new durability mode</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - if mode is null</dd>
</dl>
</li>
</ul>
<a id="durabilityMode()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>durabilityMode</h4>
<pre class="methodSignature"><a href="DurabilityMode.html" title="enum in org.cojen.tupl">DurabilityMode</a>&nbsp;durabilityMode()</pre>
<div class="block">Returns the durability mode of this transaction.</div>
</li>
</ul>
<a id="check()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>check</h4>
<pre class="methodSignature">void&nbsp;check()
    throws <a href="DatabaseException.html" title="class in org.cojen.tupl">DatabaseException</a></pre>
<div class="block">Checks the validity of the transaction.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="InvalidTransactionException.html" title="class in org.cojen.tupl">InvalidTransactionException</a></code> - if transaction is broken or was invalidated by
 an earlier exception</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if transaction is bogus</dd>
<dd><code><a href="DatabaseException.html" title="class in org.cojen.tupl">DatabaseException</a></code></dd>
</dl>
</li>
</ul>
<a id="commit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre class="methodSignature">void&nbsp;commit()
     throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Commits all modifications made within the current transaction scope. The
 current scope is still valid after this method is called, unless an
 exception is thrown. Call exit or reset to fully release transaction
 resources.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="commitAll()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commitAll</h4>
<pre class="methodSignature">void&nbsp;commitAll()
        throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Commits and exits all transaction scopes.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="enter()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enter</h4>
<pre class="methodSignature">void&nbsp;enter()
    throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Enters a nested transaction scope.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="exit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exit</h4>
<pre class="methodSignature">void&nbsp;exit()
   throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Exits the current transaction scope, rolling back all uncommitted
 modifications made within. The transaction is still valid after this
 method is called, unless an exception is thrown.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="reset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reset</h4>
<pre class="methodSignature">void&nbsp;reset()
    throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Exits all transaction scopes, rolling back all uncommitted modifications. Equivalent to:

 <pre>
 while (txn.isNested()) {
     txn.exit();
 }
 txn.exit();
 </pre></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="reset(java.lang.Throwable)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reset</h4>
<pre class="methodSignature">default&nbsp;void&nbsp;reset&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang" class="externalLink">Throwable</a>&nbsp;cause)</pre>
<div class="block">Reset the transaction due to the given cause. This provides an opportunity to prevent
 this transaction from being used any further. No exception is thrown when invoking this
 method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cause</code> - pass a cause to reset and disable the transaction; pass null to simply
 reset the transaction and ignore any exception when doing so</dd>
</dl>
</li>
</ul>
<a id="lockShared(long,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockShared</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockShared&#8203;(long&nbsp;indexId,
                      byte[]&nbsp;key)
               throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction
 already owns a strong enough lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted or timed out</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockUpgradable(long,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockUpgradable</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockUpgradable&#8203;(long&nbsp;indexId,
                          byte[]&nbsp;key)
                   throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction already owns a strong enough
 lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockExclusive(long,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockExclusive</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockExclusive&#8203;(long&nbsp;indexId,
                         byte[]&nbsp;key)
                  throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>,
 transaction already owns exclusive lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="customRedo(byte[],long,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>customRedo</h4>
<pre class="methodSignature">void&nbsp;customRedo&#8203;(byte[]&nbsp;message,
                long&nbsp;indexId,
                byte[]&nbsp;key)
         throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Supply a message for a custom redo handler. Redo operations should be paired with undo
 operations.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>message</code> - message to pass to transaction handler</dd>
<dd><code>indexId</code> - index for lock acquisition; zero if not applicable</dd>
<dd><code>key</code> - key which has been locked exclusively; null if not applicable</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no transaction handler is installed; if index and key
 are provided but lock isn't held</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalArgumentException</a></code> - if index id is zero and key is non-null</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="ext/TransactionHandler.html" title="interface in org.cojen.tupl.ext"><code>TransactionHandler</code></a></dd>
</dl>
</li>
</ul>
<a id="customUndo(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>customUndo</h4>
<pre class="methodSignature">void&nbsp;customUndo&#8203;(byte[]&nbsp;message)
         throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Supply a message for a custom undo handler. Undo operations should be paired with redo
 operations.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>message</code> - message to pass to transaction handler</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no transaction handler is installed</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="ext/TransactionHandler.html" title="interface in org.cojen.tupl.ext"><code>TransactionHandler</code></a></dd>
</dl>
</li>
</ul>
<a id="isNested()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isNested</h4>
<pre class="methodSignature">boolean&nbsp;isNested()</pre>
<div class="block">Returns true if the current transaction scope is nested.</div>
</li>
</ul>
<a id="nestingLevel()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nestingLevel</h4>
<pre class="methodSignature">int&nbsp;nestingLevel()</pre>
<div class="block">Counts the current transaction scope nesting level. Count is zero if non-nested.</div>
</li>
</ul>
<a id="tryLockShared(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryLockShared</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;tryLockShared&#8203;(long&nbsp;indexId,
                         byte[]&nbsp;key,
                         long&nbsp;nanosTimeout)
                  throws <a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></pre>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction
 already owns a strong enough lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockShared(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockShared</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockShared&#8203;(long&nbsp;indexId,
                      byte[]&nbsp;key,
                      long&nbsp;nanosTimeout)
               throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive
 locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction
 already owns a strong enough lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted or timed out</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="tryLockUpgradable(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryLockUpgradable</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;tryLockUpgradable&#8203;(long&nbsp;indexId,
                             byte[]&nbsp;key,
                             long&nbsp;nanosTimeout)
                      throws <a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></pre>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction already owns a strong enough
 lock, and no extra unlock should be performed. If <a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a> is returned, transaction holds a shared
 lock, which cannot be upgraded.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a>, <a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockUpgradable(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockUpgradable</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockUpgradable&#8203;(long&nbsp;indexId,
                          byte[]&nbsp;key,
                          long&nbsp;nanosTimeout)
                   throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying
 exclusive and additional upgradable locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction already owns a strong enough
 lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="tryLockExclusive(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryLockExclusive</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;tryLockExclusive&#8203;(long&nbsp;indexId,
                            byte[]&nbsp;key,
                            long&nbsp;nanosTimeout)
                     throws <a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></pre>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>, transaction already owns exclusive lock, and no extra unlock
 should be performed. If <a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a> is returned,
 transaction holds a shared lock, which cannot be upgraded.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a>, <a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockExclusive(long,byte[],long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockExclusive</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockExclusive&#8203;(long&nbsp;indexId,
                         byte[]&nbsp;key,
                         long&nbsp;nanosTimeout)
                  throws <a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></pre>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks. If return value is <a href="LockResult.html#alreadyOwned()"><code>owned</code></a>,
 transaction already owns exclusive lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting full timeout</dd>
</dl>
</li>
</ul>
<a id="lockCheck(long,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lockCheck</h4>
<pre class="methodSignature"><a href="LockResult.html" title="enum in org.cojen.tupl">LockResult</a>&nbsp;lockCheck&#8203;(long&nbsp;indexId,
                     byte[]&nbsp;key)</pre>
<div class="block">Checks the lock ownership for the given key.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="LockResult.html#UNOWNED"><code>UNOWNED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
</dl>
</li>
</ul>
<a id="lastLockedIndex()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastLockedIndex</h4>
<pre class="methodSignature">long&nbsp;lastLockedIndex()</pre>
<div class="block">Returns the index id of the last lock acquired, within the current scope.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>locked index id</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held</dd>
</dl>
</li>
</ul>
<a id="lastLockedKey()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastLockedKey</h4>
<pre class="methodSignature">byte[]&nbsp;lastLockedKey()</pre>
<div class="block">Returns the key of the last lock acquired, within the current scope.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>locked key; instance is not cloned</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held</dd>
</dl>
</li>
</ul>
<a id="unlock()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unlock</h4>
<pre class="methodSignature">void&nbsp;unlock()</pre>
<div class="block">Fully releases the last lock or group acquired, within the current scope. If the last
 lock operation was an upgrade, for a lock not immediately acquired, unlock is not
 allowed. Instead, an IllegalStateException is thrown.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held, or if crossing a scope boundary, or if
 unlocking a non-immediate upgrade</dd>
</dl>
</li>
</ul>
<a id="unlockToShared()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unlockToShared</h4>
<pre class="methodSignature">void&nbsp;unlockToShared()</pre>
<div class="block">Releases the last lock or group acquired, within the current scope, retaining a shared
 lock. If the last lock operation was an upgrade, for a lock not immediately acquired,
 unlock is not allowed. Instead, an IllegalStateException is thrown.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held, or if crossing a scope boundary, or if
 too many shared locks, or if unlocking a non-immediate upgrade</dd>
</dl>
</li>
</ul>
<a id="unlockToUpgradable()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unlockToUpgradable</h4>
<pre class="methodSignature">void&nbsp;unlockToUpgradable()</pre>
<div class="block">Releases the last lock or group acquired or upgraded, within the current scope,
 retaining an upgradable lock.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held, or if crossing a scope boundary, or if
 last lock is shared</dd>
</dl>
</li>
</ul>
<a id="unlockCombine()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unlockCombine</h4>
<pre class="methodSignature">void&nbsp;unlockCombine()</pre>
<div class="block">Combines the last lock acquired or upgraded into a group which can be unlocked together.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if no locks held, or if crossing a scope boundary, or if
 combining an acquire with an upgrade</dd>
</dl>
</li>
</ul>
<a id="getId()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre class="methodSignature">default&nbsp;long&nbsp;getId()</pre>
<div class="block">Returns the currently assigned identifier for this transaction, which is zero when the
 transaction cannot replicate. After the transaction has finished, a new identifier is
 generated when requested again.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a positive transaction identifier, or zero if transaction cannot replicate</dd>
</dl>
</li>
</ul>
<a id="prepare()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepare</h4>
<pre class="methodSignature">default&nbsp;void&nbsp;prepare()
              throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Prepares a transaction for finishing a two-phase commit, to be called before fully
 committing the transaction. A recovery <a href="DatabaseConfig.html#recoveryHandler(org.cojen.tupl.ext.RecoveryHandler)"><code>handler</code></a>
 must be installed, and the transaction must be <a href="#check()"><code>valid</code></a>.

 <p>Prior to calling prepare, applications are expected to have stored additional state,
 keyed by the transaction <a href="#getId()"><code>identifier</code></a>. This state should be stored into
 indexes of the same database, and within this transaction as well. When the recovery
 handler is invoked, it can continue the transaction workflow, by loading the previously
 stored state.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang" class="externalLink">IllegalStateException</a></code> - if transaction isn't a state for supporting two-phase commit</dd>
<dd><code><a href="UnmodifiableReplicaException.html" title="class in org.cojen.tupl">UnmodifiableReplicaException</a></code> - if transaction cannot replicate</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/UnsupportedOperationException.html?is-external=true" title="class or interface in java.lang" class="externalLink">UnsupportedOperationException</a></code> - if completely unsupported by the transaction
 implementation</dd>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
<a id="attach(java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attach</h4>
<pre class="methodSignature">default&nbsp;void&nbsp;attach&#8203;(<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;obj)</pre>
<div class="block">Attach an arbitrary object to this transaction instance, for tracking it. Attachments
 can become visible to other threads as a result of a <a href="LockTimeoutException.html" title="class in org.cojen.tupl"><code>LockTimeoutException</code></a>. A
 happens-before relationship is guaranteed only if the attachment is set before the
 associated lock is acquired. Also, the LockTimeoutException constructor calls toString
 on the attachment, and includes it in the message. A non-default toString implementation
 must consider thread-safety.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obj</code> - the object to be attached; may be null</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/UnsupportedOperationException.html?is-external=true" title="class or interface in java.lang" class="externalLink">UnsupportedOperationException</a></code> - if completely unsupported by the transaction
 implementation</dd>
</dl>
</li>
</ul>
<a id="attachment()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attachment</h4>
<pre class="methodSignature">default&nbsp;<a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>&nbsp;attachment()</pre>
<div class="block">Returns any attachment which was set earlier.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the current attachment, or null if none</dd>
</dl>
</li>
</ul>
<a id="flush()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>flush</h4>
<pre class="methodSignature">void&nbsp;flush()
    throws <a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></pre>
<div class="block">Manually flush all buffered changes made by this transaction to the shared redo
 log. Flushing is performed automatically when the buffer fills up, or when the
 transaction is committed. Flushing can be used in conjunction with replication, to
 ensure that locks and changes are visible to replicas before the transaction commits.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/Flushable.html?is-external=true#flush()" title="class or interface in java.io" class="externalLink">flush</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/Flushable.html?is-external=true" title="class or interface in java.io" class="externalLink">Flushable</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/10/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Transaction.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2011&#x2013;2019 <a href="https://github.com/cojen">Cojen</a>. All rights reserved.</small></p>
</footer>
</body>
</html>
